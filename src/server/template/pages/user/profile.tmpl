{{define "content"}}
<div class="user-page profile-page">
    <div class="page-header">
        <h1>{{t "user.profile.title"}}</h1>
        <p class="page-subtitle">Manage your account information</p>
    </div>

    <div class="user-container">
        <nav class="user-nav">
            <a href="/users/profile" class="nav-item active">{{t "user.profile"}}</a>
            <a href="/users/security" class="nav-item">{{t "user.security"}}</a>
            <a href="/users/tokens" class="nav-item">{{t "user.tokens"}}</a>
        </nav>

        <div class="user-content">
            {{if .Flash}}
            <div class="alert alert-{{.Flash.Type}}" role="alert">
                {{.Flash.Message}}
            </div>
            {{end}}

            <form method="POST" action="/users/profile" class="profile-form" enctype="multipart/form-data">
                <input type="hidden" name="csrf_token" value="{{.CSRFToken}}">

                <div class="profile-section">
                    <h2>Profile Information</h2>

                    <div class="avatar-section">
                        <div class="current-avatar">
                            {{if .User.AvatarURL}}
                            <img src="{{.User.AvatarURL}}" alt="Avatar" class="avatar-img">
                            {{else}}
                            <div class="avatar-placeholder">{{slice .User.Username 0 1 | upper}}</div>
                            {{end}}
                        </div>
                        <div class="avatar-actions">
                            <label class="btn btn-secondary btn-sm">
                                {{t "common.upload"}}
                                <input type="file" name="avatar" accept="image/*" class="hidden">
                            </label>
                            {{if .User.AvatarURL}}
                            <button type="button" class="btn btn-danger btn-sm" name="remove_avatar" value="1">
                                {{t "common.delete"}}
                            </button>
                            {{end}}
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="username">Username</label>
                            <input type="text" id="username" value="{{.User.Username}}" disabled
                                   class="input-disabled">
                            <small class="form-help">Username cannot be changed</small>
                        </div>

                        <div class="form-group">
                            <label for="display_name">{{t "user.profile.display_name"}}</label>
                            <input type="text" id="display_name" name="display_name"
                                   value="{{.User.DisplayName}}" maxlength="64"
                                   placeholder="{{.User.Username}}">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="bio">{{t "user.profile.bio"}}</label>
                        <textarea id="bio" name="bio" rows="3" maxlength="500"
                                  placeholder="Tell us about yourself">{{.User.Bio}}</textarea>
                        <small class="form-help char-count"><span id="bio-count">{{len .User.Bio}}</span>/500</small>
                    </div>
                </div>

                <div class="profile-section">
                    <h2>Email Settings</h2>

                    <div class="form-group">
                        <label for="email">{{t "user.profile.email"}} (Account)</label>
                        <div class="input-with-badge">
                            <input type="email" id="email" name="email" value="{{.User.Email}}" required>
                            {{if .User.EmailVerified}}
                            <span class="badge badge-success">Verified</span>
                            {{else}}
                            <span class="badge badge-warning">Unverified</span>
                            {{end}}
                        </div>
                        <small class="form-help">Used for security alerts and password recovery</small>
                    </div>

                    <div class="form-group">
                        <label for="notification_email">Notification Email (Optional)</label>
                        <div class="input-with-badge">
                            <input type="email" id="notification_email" name="notification_email"
                                   value="{{.User.NotificationEmail}}"
                                   placeholder="Leave empty to use account email">
                            {{if and .User.NotificationEmail .User.NotificationEmailVerified}}
                            <span class="badge badge-success">Verified</span>
                            {{else if .User.NotificationEmail}}
                            <span class="badge badge-warning">Unverified</span>
                            {{end}}
                        </div>
                        <small class="form-help">Used for newsletters and general notifications</small>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">{{t "form.save"}}</button>
                </div>
            </form>
        </div>
    </div>
</div>
{{/* Per AI.md PART 16: NO inline CSS/JS - all styles in main.css, scripts in app.js */}}
{{end}}
